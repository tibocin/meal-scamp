{"version":3,"file":"Planner-CBU7E3Cq.js","sources":["../../../.svelte-kit/adapter-node/chunks/Planner.js"],"sourcesContent":["import { c as create_ssr_component, b as each, e as escape, d as add_attribute } from \"./ssr.js\";\nimport { p as plan, m as meals } from \"./stores.js\";\nconst days = 7;\nconst Planner = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  let counts;\n  let shopping;\n  let start = /* @__PURE__ */ new Date();\n  let mealMap = {};\n  plan.subscribe((v) => mealMap = v);\n  function dates() {\n    const out = [];\n    const s = new Date(start);\n    for (let i = 0; i < days; i++) {\n      const d = new Date(s);\n      d.setDate(s.getDate() + i);\n      out.push(d.toISOString().slice(0, 10));\n    }\n    return out;\n  }\n  let allMeals = [];\n  meals.subscribe((v) => allMeals = v);\n  if (allMeals.length === 0) {\n    fetch(\"/api/seed\").then((r) => r.json()).then((data) => meals.set(data));\n  }\n  function getMealsForDate(date) {\n    return mealMap[date] || [];\n  }\n  function getMealName(id) {\n    const meal = allMeals.find((x) => x.id === id);\n    return meal ? meal.name : id;\n  }\n  counts = (() => {\n    const c = {};\n    Object.values(mealMap).forEach((arr) => arr.forEach((m) => {\n      c[m] = (c[m] || 0) + 1;\n    }));\n    return c;\n  })();\n  shopping = (() => {\n    const out = {};\n    const mealsById = Object.fromEntries(allMeals.map((m) => [m.id, m]));\n    for (const arr of Object.values(mealMap)) {\n      for (const id of arr) {\n        const m = mealsById[id];\n        if (!m) continue;\n        for (const ing of m.ingredients) {\n          out[ing.name] = (out[ing.name] || 0) + (ing.amount || 0);\n        }\n      }\n    }\n    return out;\n  })();\n  return `<div class=\"space-y-4\"><div class=\"card\"><h3 class=\"font-semibold mb-2\" data-svelte-h=\"svelte-shm20h\">Add Meals to Days</h3> <div class=\"flex gap-2 flex-wrap\">${each(allMeals, (m) => {\n    return `<button class=\"btn-outline\">${escape(m.name)}</button>`;\n  })}</div></div> <div class=\"grid md:grid-cols-2 gap-4\"><div class=\"card\"><h3 class=\"font-semibold mb-2\">Plan (${escape(days)} days)</h3> ${each(dates(), (d) => {\n    return `<div class=\"mb-3\"><div class=\"text-sm text-gray-500\">${escape(d)}</div> <div class=\"flex flex-wrap gap-2 mt-1\">${getMealsForDate(d).length === 0 ? `<span class=\"tag\" data-svelte-h=\"svelte-e35gwc\">No meals yet</span>` : `${each(getMealsForDate(d), (id, i) => {\n      return `<button class=\"tag\">${escape(getMealName(id))} ✕</button>`;\n    })}`}</div> <div class=\"mt-2\"><select class=\"border p-1\"><option value=\"\" data-svelte-h=\"svelte-1uktmxh\">+ Add meal</option>${each(allMeals, (m) => {\n      return `<option${add_attribute(\"value\", m.id, 0)}>${escape(m.name)}</option>`;\n    })}</select></div> </div>`;\n  })}</div> <div class=\"card\"><h3 class=\"font-semibold mb-2\" data-svelte-h=\"svelte-1hur4qz\">Batch Prep Counts</h3> ${each(Object.entries(counts), ([id, n]) => {\n    return `<div class=\"flex justify-between border-b py-1 text-sm\"><span>${escape(getMealName(id))}</span> <span class=\"font-mono\">${escape(n)}×</span> </div>`;\n  })} <h3 class=\"font-semibold mt-4 mb-2\" data-svelte-h=\"svelte-1s63wpa\">Shopping List (aggregated)</h3> ${each(Object.entries(shopping), ([name, amt]) => {\n    return `<div class=\"flex justify-between border-b py-1 text-sm\"><span>${escape(name)}</span><span class=\"font-mono\">${escape(amt)}</span> </div>`;\n  })}</div></div></div>`;\n});\nexport {\n  Planner as P\n};\n"],"names":[],"mappings":"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"}